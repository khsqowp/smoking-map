### **보안 분석 보고서 (Security Analysis Report)**

**프로젝트:** Smoking Map  
**분석 일자:** 2025년 8월 29일  
**분석 목표:** 다양한 외부 사이버 위협에 대한 현재 애플리케이션의 보안 적용 상태를 점검하고, 잠재적 취약점을 식별하여 개선 방안을 제시합니다.

---

### **1. 총평 (Executive Summary)**

본 프로젝트는 Spring Security, OAuth2 인증, CSRF 방어, API 속도 제한 등 최신 웹 프레임워크가 제공하는 강력한 보안 기능들을 적극적으로 활용하여 준수한 보안 수준을 갖추고 있습니다. 특히 민감 정보의 환경 변수 관리와 의존성 자동 점검(Dependabot) 설정은 매우 긍정적입니다.

하지만 **보안 헤더 설정 미비**, **의존성 관리의 사각지대**, **상세 로깅 및 모니터링 부재** 등 인프라 및 애플리케이션 운영 관점에서 보완이 필요한 영역들이 식별되었습니다. 아래의 상세 분석 및 권고 사항을 통해 애플리케이션의 방어 능력을 한 단계 더 강화할 수 있습니다.

---

### **2. 상세 분석 및 권고 사항**

#### **2.1. 인증 및 세션 관리 (Authentication & Session Management)**

*   **[✔ 적용됨] OAuth 2.0 기반의 안전한 인증**:
    *   Google 소셜 로그인을 통해 인증을 처리하므로, 비밀번호 관리의 부담과 위험을 외부 전문 서비스에 위임합니다. 이는 크리덴셜 스터핑(Credential Stuffing)과 같은 공격에 매우 효과적인 방어책입니다.

*   **[✔ 적용됨] 안전한 세션 관리**:
    *   Spring Session이 세션 관리를 담당하며, 세션 타임아웃이 90일로 설정되어 있습니다. Spring Security는 세션 고정(Session Fixation) 공격을 기본적으로 방어합니다.

*   **[△ 개선 권고] 다중 인증(MFA) 부재**:
    *   **위협**: 관리자 계정과 같이 높은 권한을 가진 계정이 탈취될 경우, 시스템에 심각한 피해를 줄 수 있습니다.
    *   **권고**: 관리자 계정에 대해서는 이메일, OTP 등을 활용한 다중 인증(MFA) 도입을 장기적으로 검토하여 인증 체계를 강화해야 합니다.

#### **2.2. 접근 제어 (Authorization)**

*   **[✔ 적용됨] 역할 기반 접근 제어(RBAC)**:
    *   Spring Security를 통해 `USER`, `ADMIN`, `MANAGER` 역할(Role)을 명확히 구분하고, 각 API 엔드포인트에 대한 접근 권한을 역할에 따라 부여(`hasRole`, `hasAnyRole`)하고 있습니다. 이는 권한 없는 사용자의 중요 기능 접근을 효과적으로 차단합니다.

*   **[△ 개선 권고] 최소 권한 원칙 검토**:
    *   **위협**: 현재의 권한 설정이 비즈니스 로직상 완벽하다고 단정하기 어렵습니다. 과도한 권한이 부여된 API가 존재할 수 있습니다.
    *   **권고**: 주기적으로 모든 API 엔드포인트의 권한 설정을 검토하여, 각 역할에 필요한 최소한의 권한만 부여되었는지 확인하는 프로세스를 갖추는 것이 좋습니다.

#### **2.3. 입력값 검증 및 주요 공격 방어**

*   **[✔ 적용됨] SQL 인젝션(SQL Injection) 방어**:
    *   Spring Data JPA와 Hibernate를 사용함으로써, 모든 데이터베이스 쿼리는 파라미터화된 쿼리(Parameterized Query)로 실행됩니다. 이는 SQL 인젝션 공격을 근본적으로 방어하는 매우 효과적인 방법입니다.

*   **[✔ 적용됨] CSRF(Cross-Site Request Forgery) 방어**:
    *   Spring Security의 CSRF 보호 기능이 활성화되어 있으며, 프론트엔드의 `apiClient`가 모든 요청에 `X-XSRF-TOKEN` 헤더를 포함하여 전송하도록 구현되어 있습니다.

*   **[△ 개선 권고] XSS(Cross-Site Scripting) 방어 보완**:
    *   **현황**: React는 기본적으로 JSX에 렌더링되는 모든 값을 문자열로 처리하여 XSS 공격을 방어합니다.
    *   **위협**: 향후 `dangerouslySetInnerHTML`과 같은 속성을 사용하거나, 사용자 입력값을 URL 등으로 사용할 경우 XSS 취약점이 발생할 수 있습니다.
    *   **권고**: 아래 "2.4. 보안 설정 및 강화" 항목의 **CSP(Content-Security-Policy) 헤더**를 도입하여, 신뢰할 수 없는 외부 스크립트의 실행을 브라우저 레벨에서 차단하는 강력한 추가 방어 계층을 마련해야 합니다.

*   **[△ 개선 권고] 파일 업로드 취약점**:
    *   **현황**: `FileValidator`에서 파일의 MIME 타입과 확장자를 검사하는 로직이 구현되어 있습니다.
    *   **위협**: 악의적으로 조작된 파일(웹셸, 바이러스 등)이 서버에 업로드되어 실행될 경우, 서버가 장악될 수 있습니다.
    *   **권고**:
        1.  업로드된 파일에 대해 서버 측에서 바이러스 스캔을 수행하는 로직을 추가하는 것을 고려해야 합니다.
        2.  업로드된 파일은 웹 애플리케이션과 완전히 분리된 도메인(CDN 등)을 통해 서빙하는 것이 가장 안전합니다.

#### **2.4. 서비스 거부 공격 (DoS/DDoS)**

*   **[✔ 적용됨] 애플리케이션 레벨 DoS 방어**:
    *   `Bucket4j` 라이브러리를 통해 API 요청에 대한 속도 제한(Rate Limiting)을 구현했습니다. 이는 특정 API에 대한 과도한 요청으로 인해 서버 리소스가 고갈되는 것을 방지하는 훌륭한 방어책입니다.

*   **[△ 개선 권고] 인프라 레벨 DDoS 방어**:
    *   **위협**: 현재의 방어책은 애플리케이션 레벨에 한정되며, 대규모 네트워크 트래픽을 동반하는 DDoS 공격은 막을 수 없습니다.
    *   **권고**: 실제 프로덕션 환경에서는 Cloudflare, AWS Shield와 같은 전문 DDoS 방어 서비스나 WAF(Web Application Firewall)를 인프라 앞단에 도입하여 네트워크 레벨의 공격을 방어해야 합니다.

#### **2.5. 보안 설정 및 강화 (Security Hardening)**

*   **[✔ 적용됨] 민감 정보의 안전한 관리**:
    *   데이터베이스 비밀번호, API 키 등 모든 민감 정보는 소스 코드에서 분리되어 환경 변수를 통해 주입되고 있습니다. `.gitignore` 파일에도 `.env` 파일이 올바르게 포함되어 있어, 민감 정보가 Git 저장소에 노출될 위험을 차단하고 있습니다.

*   **[🚨 위험] 보안 헤더(Security Headers) 미적용**:
    *   **위협**: `next.config.mjs` 파일에서 `headers` 함수가 빈 배열을 반환하도록 설정되어 있습니다. 이로 인해 XSS, 클릭재킹(Clickjacking), 프로토콜 다운그레이드 등 다양한 공격에 브라우저가 무방비로 노출됩니다.
    *   **권고**: **시급히** 아래와 같은 보안 헤더를 적용해야 합니다.
        *   `Content-Security-Policy (CSP)`: 신뢰할 수 있는 출처의 스크립트, 스타일시트, 이미지 등만 로드하도록 제한하여 XSS 공격을 효과적으로 방어합니다.
        *   `Strict-Transport-Security (HSTS)`: 브라우저가 항상 HTTPS로만 사이트에 접속하도록 강제합니다.
        *   `X-Content-Type-Options: nosniff`: 브라우저가 `Content-Type`을 무시하고 파일 내용을 추측하여 실행하는 것을 방지합니다.
        *   `X-Frame-Options: DENY` 또는 `SAMEORIGIN`: 다른 사이트에서 `<iframe>`을 통해 페이지를 렌더링하는 것을 막아 클릭재킹 공격을 방어합니다.

#### **2.6. 의존성 및 공급망 보안 (Dependency & Supply Chain Security)**

*   **[✔ 적용됨] 의존성 취약점 자동 탐지**:
    *   `dependabot.yml` 파일이 설정되어 있어, 프로젝트가 사용하는 외부 라이브러리(의존성)에서 새로운 보안 취약점이 발견될 경우 자동으로 알려주고 수정을 제안합니다.

*   **[△ 개선 권고] 주기적인 수동 검사 및 관리**:
    *   **위협**: Dependabot은 편리하지만, 모든 취약점을 탐지하지 못할 수 있으며, 즉시 수정되지 않는 경우도 있습니다.
    *   **권고**: `npm audit` (프론트엔드), OWASP Dependency-Check Gradle 플러그인 (백엔드) 등을 통해 주기적으로 의존성 취약점을 수동으로 검사하고, 사용하지 않는 라이브러리는 제거하여 공격 표면을 최소화해야 합니다.

#### **2.7. 로깅 및 모니터링 (Logging & Monitoring)**

*   **[✔ 적용됨] 기본 활동 로깅**:
    *   `UserActivityLog`를 통해 사용자의 주요 활동(좌표 등)을 기록하고 있습니다.

*   **[△ 개선 권고] 보안 이벤트 로깅 및 모니터링 부재**:
    *   **위협**: 현재는 비정상적인 활동이나 보안 공격 시도를 탐지하고 대응할 수 있는 체계적인 모니터링 시스템이 없습니다.
    *   **권고**:
        1.  **로그 중앙화**: 모든 로그(애플리케이션, 웹 서버, 데이터베이스 등)를 ELK Stack, Splunk, AWS CloudWatch Logs와 같은 중앙화된 로깅 시스템으로 수집해야 합니다.
        2.  **이상 징후 모니터링**: 반복적인 로그인 실패, 권한 없는 API 접근 시도, 비정상적인 트래픽 증가 등 보안 위협으로 의심되는 활동에 대해 실시간으로 경고(Alert)를 발생시키는 모니터링 시스템을 구축해야 합니다.